# AWS Database Migration Service (DMS) ‚Äî Step-by-Step Practical Guide

## üìò Overview

**AWS Database Migration Service (DMS)** helps you **migrate databases** quickly and securely from **on-premises**, **EC2**, or **other cloud providers** to **AWS-managed databases** (like RDS, Aurora, Redshift, DynamoDB, etc.).

DMS performs **continuous data replication** with minimal downtime.

---

## üß© Prerequisites

Before starting:

* You have **source and target databases** (e.g., On-prem MySQL ‚Üí AWS RDS MySQL)
* Network connectivity between both databases
* IAM user with DMS permissions:

  * `AmazonDMSVPCManagementRole`
  * `AmazonDMSCloudWatchLogsRole`
  * `AmazonDMSRedshiftS3Role`
  * `AmazonDMSFullAccess`
* Security groups and firewalls allow access (port 3306 for MySQL, 1433 for SQL Server, etc.)

---

## üë§ Step 1: Create IAM User for DMS

### Navigate:

**AWS Console ‚Üí IAM ‚Üí Users ‚Üí Create user**

* **User name:** `DMSuser-sourav`
* **Access type:** Programmatic & Console access

### Attach Permissions:

1. `AmazonDMSFullAccess`
2. `AmazonDMSVPCManagementRole`
3. `AmazonDMSCloudWatchLogsRole`
4. (Optional) `AmazonS3FullAccess` if using S3 as target/source

‚úÖ Create Access Key & Secret Key (if connecting DMS via CLI/agent)

---

## üåê Step 2: Configure Networking (VPC)

1. Go to **VPC ‚Üí Subnets ‚Üí Security Groups**
2. Ensure:

   * Your **source DB** (on-prem/EC2) is reachable from AWS
   * The **replication instance** can reach both source and target endpoints
3. Open necessary **DB ports** (e.g., 3306 for MySQL, 1433 for MSSQL)
4. Add inbound rule:

   ```
   Type: MySQL/Aurora (3306)
   Source: DMS Replication Instance Security Group
   ```

---

## ‚öôÔ∏è Step 3: Create a Replication Instance

This instance runs the DMS replication engine.

### Navigate:

**AWS Console ‚Üí Database Migration Service ‚Üí Replication Instances ‚Üí Create replication instance**

### Configuration:

| Field               | Example Value              | Description                        |
| ------------------- | -------------------------- | ---------------------------------- |
| Name                | `dms-replication-instance` | Name for your instance             |
| Instance class      | `dms.t3.medium`            | Choose size based on data volume   |
| Storage             | 100 GB                     | Disk storage                       |
| VPC                 | Select your existing VPC   | Ensure connectivity                |
| Multi-AZ            | Optional                   | For high availability              |
| Publicly accessible | Yes/No                     | Enable if source DB is outside VPC |

Click **Create**
üü¢ Wait for **Status = Available**

---

## üóùÔ∏è Step 4: Create Source and Target Endpoints

### Navigate:

**AWS Console ‚Üí DMS ‚Üí Endpoints ‚Üí Create Endpoint**

#### üü† Source Endpoint:

| Parameter           | Example                                     |
| ------------------- | ------------------------------------------- |
| Endpoint type       | Source                                      |
| Endpoint identifier | `onprem-mysql-src`                          |
| Source engine       | MySQL                                       |
| Server name         | IP/hostname of source DB                    |
| Port                | 3306                                        |
| Username            | dbuser                                      |
| Password            | ********                                    |
| SSL Mode            | None or require                             |
| Test connection     | ‚úÖ (after replication instance is available) |

#### üü¢ Target Endpoint:

| Parameter           | Example              |
| ------------------- | -------------------- |
| Endpoint type       | Target               |
| Endpoint identifier | `aws-rds-target`     |
| Target engine       | Amazon RDS for MySQL |
| Server name         | RDS endpoint         |
| Port                | 3306                 |
| Username            | admin                |
| Password            | ********             |
| Test connection     | ‚úÖ Successful         |

‚úÖ Once both test connections succeed ‚Üí Save endpoints.

---

## üß† Step 5: Create a Database Migration Task

This defines **what data** is migrated and **how**.

### Navigate:

**AWS Console ‚Üí DMS ‚Üí Database Migration Tasks ‚Üí Create task**

| Field                | Value / Example                                                |
| -------------------- | -------------------------------------------------------------- |
| Task identifier      | `mysql-to-rds-migration`                                       |
| Replication instance | Select your instance                                           |
| Source endpoint      | `onprem-mysql-src`                                             |
| Target endpoint      | `aws-rds-target`                                               |
| Migration type       | Choose one:                                                    |
|                      | üîπ *Migrate existing data only*                                |
|                      | üîπ *Migrate existing data and replicate ongoing changes* (CDC) |
|                      | üîπ *Replicate data changes only*                               |
| Table mappings       | Include/exclude specific tables or schemas                     |
| Start task on create | ‚úÖ (optional)                                                   |

Click **Create task**

üü° Wait until **Status: Running ‚Üí Load complete, replication ongoing**

---

## üìä Step 6: Monitor Migration Progress

Go to:
**DMS ‚Üí Database migration tasks ‚Üí <your task>**

Check:

* **Table statistics**
* **Migration logs**
* **Throughput metrics**
* **Errors or warnings**

### CloudWatch Metrics:

* `CDCLatencySource`
* `FullLoadThroughputBandwidth`
* `LatencyTarget`

These help ensure replication speed and performance.

---

## üß™ Step 7: Validate and Test

Once the migration finishes:

1. Connect to your **target database (RDS)**.
2. Verify:

   * Table counts match
   * Data integrity is correct
   * Indexes and constraints are applied properly
3. If **ongoing replication (CDC)** is enabled ‚Äî make changes in the source DB and confirm they replicate to target.

---

## üöÄ Step 8: Cutover (Switch Application)

When validation is complete:

1. Stop ongoing replication task.
2. Point your **application connection string** to the **target (RDS)** database.
3. Confirm that application runs successfully with new database.
4. Decommission source or stop DMS instance (optional).

---

## ‚úÖ Summary

| Step | Action                           | Description                                |
| ---- | -------------------------------- | ------------------------------------------ |
| 1    | Create IAM User                  | `DMSuser-sourav` with required permissions |
| 2    | Configure VPC                    | Ensure network access to DBs               |
| 3    | Create Replication Instance      | Core compute for DMS                       |
| 4    | Create Source & Target Endpoints | Define databases                           |
| 5    | Create Migration Task            | Choose what & how to migrate               |
| 6    | Monitor Migration                | Track via logs & metrics                   |
| 7    | Validate Data                    | Verify migrated data                       |
| 8    | Cutover                          | Point apps to target                       |
| 9    | Cleanup                          | Decommission resources                     |

---

## üí° Common DMS SQL Queries (for Validation)

You can run these on **source vs. target** to validate data:

### üîπ Record Count Check

```sql
SELECT COUNT(*) FROM employees;
```

### üîπ Data Sum Check

```sql
SELECT SUM(salary) FROM employees;
```

### üîπ Recent Data Check

```sql
SELECT * FROM orders ORDER BY order_date DESC LIMIT 10;
```

---

## üß† Best Practices

* Always test **connectivity (Test endpoint)** before task creation.
* Start with **small test migrations** before full cutover.
* Use **ongoing replication** for zero-downtime migrations.
* Monitor CloudWatch metrics for lag and throughput.
* Prefer **Multi-AZ replication instance** for production.

